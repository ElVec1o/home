---
import Base from '../layouts/Base.astro';
import breaksData from '../data/breaks.json';
import siteConfig from '../data/site-config.json';

const totalBreaks = breaksData.length;
const categories = [...new Set(breaksData.filter(b => b.category).map(b => b.category.split(' ')[1]))];
const base = import.meta.env.BASE_URL;

// Filter to only entries with name/technique for Recent Work display
const recentWork = breaksData.filter(b => b.name && b.technique).slice(0, 3);
---
<Base title={siteConfig.title}>
  <h1>{siteConfig.title}</h1>
  <p>{siteConfig.tagline}</p>

  <h2>About</h2>
  <p>{siteConfig.about1}</p>
  <p>{siteConfig.about2}</p>

  <h2>Stats</h2>
  <p>
    {totalBreaks} documented posts<br>
    {categories.length} technique categories
  </p>

  <h2>Recent Work</h2>
  {recentWork.map(b => (
    <p>
      <strong>{b.name}</strong> — {b.technique}<br>
      <span class="meta">{b.challenge}</span>
    </p>
  ))}
  <p><a href={`${base}/posts/`}>→ View all posts</a></p>

  <h2>Links</h2>
  <p>
    <a href={`https://x.com/${siteConfig.xHandle}`} target="_blank">X/Twitter</a>
  </p>
  <p>
    <a href="https://app.grayswan.ai/arena/leaderboard/global" target="_blank">Gray Swan Arena Global Leaderboard</a> — competing as <strong>{siteConfig.grayswanUser}</strong>
  </p>
</Base>
